openapi: 3.0.0
paths:
  /v1/users:
    get:
      operationId: 一覧取得
      summary: ''
      parameters:
        - name: offset
          required: true
          in: query
          schema:
            minimum: 0
            title: offset
            default: 0
            type: number
        - name: limit
          required: true
          in: query
          schema:
            minimum: 0
            maximum: 200
            title: limit
            default: 25
            type: number
        - name: nickname
          required: true
          in: query
          example: みなかみはちみ
          schema:
            type: string
      responses:
        '200':
          description: ''
      tags:
        - ユーザー
  /v1/users/{nsaid}:
    get:
      operationId: 取得
      summary: ''
      parameters:
        - name: nsaid
          required: true
          in: path
          example: 91d160aa84e88da6
          schema:
            type: string
      responses:
        '200':
          description: ''
        '404':
          description: ''
      tags:
        - ユーザー
  /v1/stats/{start_time}:
    get:
      operationId: 統計取得
      summary: ''
      parameters:
        - name: nsaid
          required: true
          in: query
          description: プレイヤーID
          example: 91d160aa84e88da6
          schema:
            type: string
        - name: start_time
          required: true
          in: path
          description: スケジュールID
          example: 1655575200
          schema:
            type: number
        - name: is_clear
          required: false
          in: query
          description: クリアしたかどうか
          schema:
            type: boolean
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatsResultsDto'
        '404':
          description: ''
      tags:
        - 統計
  /v1/nickname_and_icon:
    get:
      operationId: アイコン取得
      summary: ''
      parameters:
        - name: id
          required: true
          in: query
          example:
            - 3f89c3791c43ea57
            - 8db26d4c24ee37fd
            - 7690d838ab4db5d2
            - f28328d99d9dba3c
          schema:
            type: array
            items:
              type: string
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NicknameAndIconResponseDto'
        '403':
          description: ''
      tags:
        - ユーザー
  /v1/results/{salmon_id}:
    get:
      operationId: 取得
      summary: ''
      parameters:
        - name: salmon_id
          required: true
          in: path
          description: リザルトID
          schema:
            type: integer
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
        '404':
          description: ''
      tags:
        - リザルト
    put:
      operationId: 更新
      summary: ''
      parameters:
        - name: salmon_id
          required: true
          in: path
          description: リザルトID
          schema:
            type: integer
      responses:
        '404':
          description: ''
      tags:
        - リザルト
    delete:
      operationId: 削除
      summary: ''
      parameters:
        - name: salmon_id
          required: true
          in: path
          description: リザルトID
          schema:
            type: integer
      responses:
        '404':
          description: ''
      tags:
        - リザルト
  /v1/results:
    get:
      operationId: 一括取得
      summary: ''
      parameters:
        - name: offset
          required: true
          in: query
          schema:
            minimum: 0
            title: offset
            default: 0
            type: number
        - name: limit
          required: true
          in: query
          schema:
            minimum: 0
            maximum: 200
            title: limit
            default: 25
            type: number
        - name: include_details
          required: true
          in: query
          description: 詳細データを含むかどうか
          schema:
            title: ''
            default: false
            type: boolean
        - name: order
          required: true
          in: query
          schema:
            title: order
            default: true
            type: boolean
        - name: start_time
          required: false
          in: query
          description: スケジュールID
          schema:
            title: ''
            type: number
        - name: nsaid
          required: false
          in: query
          description: プレイヤーID
          schema:
            title: ''
            type: string
        - name: is_clear
          required: false
          in: query
          description: クリアしたリザルトのみ
          schema:
            title: ''
            type: boolean
        - name: no_night_waves
          required: false
          in: query
          description: 夜イベントを含まないかどうか
          schema:
            title: ''
            type: boolean
        - name: golden_ikura_num
          required: false
          in: query
          description: 最小納品金イクラ数
          schema:
            title: ''
            type: number
        - name: ikura_num
          required: false
          in: query
          description: 最小取得赤イクラ数
          schema:
            title: ''
            type: number
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                title: PaginatedResponseOfResult
                allOf:
                  - $ref: '#/components/schemas/PaginatedDto'
                  - properties:
                      results:
                        type: array
                        items:
                          $ref: '#/components/schemas/Result'
      tags:
        - リザルト
    post:
      operationId: 登録
      summary: ''
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Results'
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UploadResults'
        '400':
          description: ''
      tags:
        - リザルト
  /v1/ranks:
    get:
      operationId: 最新の各種ランキング取得
      summary: ''
      description: シフトごとのいろんな記録を取得
      parameters: []
      responses:
        '200':
          description: ''
      tags: &ref_0
        - ランキング
  /v1/ranks/{start_time}:
    get:
      operationId: 各種ランキング取得
      summary: ''
      description: シフトごとのいろんな記録を取得
      parameters:
        - name: start_time
          required: true
          in: path
          schema:
            type: number
      responses:
        '200':
          description: ''
      tags: *ref_0
  /v1/ranks/{start_time}/users:
    get:
      operationId: ユーザランキング取得
      summary: ''
      description: シフトでの自チームのイクラ獲得ランキング
      parameters:
        - name: nsaid
          required: true
          in: query
          description: プレイヤーID
          example: 91d160aa84e88da6
          schema:
            type: string
        - name: start_time
          required: true
          in: path
          description: スケジュールID
          example: 1654020000
          schema:
            type: number
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Rank'
        '404':
          description: ''
      tags: *ref_0
  /v1/ranks/{start_time}/teams:
    get:
      operationId: チームランキング取得
      summary: ''
      description: シフトでのチームごとのイクラ獲得ランキング(WAVE記録は非対応)
      parameters:
        - name: start_time
          required: true
          in: path
          description: スケジュールID
          example: 1654020000
          schema:
            type: number
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Rank'
        '404':
          description: ''
      tags: *ref_0
  /v1/schedules:
    get:
      operationId: 取得
      summary: ''
      description: スケジュールを取得します
      parameters: []
      responses:
        '200':
          description: ''
      tags:
        - スケジュール
    post:
      operationId: 追加
      summary: ''
      parameters: []
      responses:
        '201':
          description: ''
      tags:
        - スケジュール
  /v1/schedules/{start_time}:
    get:
      operationId: 統計取得
      summary: ''
      description: スケジュールのリザルト統計を取得します
      parameters: []
      responses:
        '200':
          description: ''
      tags:
        - スケジュール
info:
  title: Salmon Stats API Documents
  description: ''
  contact: {}
tags: []
servers: []
components:
  schemas:
    IkuraStat:
      type: object
      properties:
        golden_ikura_num:
          type: number
          description: 金イクラ数
        ikura_num:
          type: number
          description: 赤イクラ数
        dead_count:
          type: number
          description: 被救助数
        help_count:
          type: number
          description: 救助数
      required:
        - golden_ikura_num
        - ikura_num
        - dead_count
        - help_count
    IkuraStats:
      type: object
      properties:
        max:
          description: 最大値
          allOf:
            - $ref: '#/components/schemas/IkuraStat'
        min:
          description: 最小値
          allOf:
            - $ref: '#/components/schemas/IkuraStat'
        avg:
          description: 平均値
          allOf:
            - $ref: '#/components/schemas/IkuraStat'
        count:
          type: number
          description: 回数
      required:
        - max
        - min
        - avg
        - count
    TotalResultDto:
      type: object
      properties:
        global:
          description: 全体
          type: array
          items:
            $ref: '#/components/schemas/IkuraStats'
        player:
          description: 指定プレイヤーを含む
          type: array
          items:
            $ref: '#/components/schemas/IkuraStats'
      required:
        - global
        - player
    SingleResultDto:
      type: object
      properties:
        global:
          description: プレイヤー全体
          allOf:
            - $ref: '#/components/schemas/IkuraStats'
        team:
          description: 指定プレイヤーとマッチングしたプレイヤー全体
          allOf:
            - $ref: '#/components/schemas/IkuraStats'
        player:
          description: 指定プレイヤー
          allOf:
            - $ref: '#/components/schemas/IkuraStats'
        crew:
          description: 指定プレイヤーとマッチングした仲間
          allOf:
            - $ref: '#/components/schemas/IkuraStats'
      required:
        - global
    LegacyStatsDto:
      type: object
      properties: {}
    StatsResultsDto:
      type: object
      properties:
        waves:
          description: WAVE記録(チーム単位)
          allOf:
            - $ref: '#/components/schemas/TotalResultDto'
        total:
          description: 総合記録(チーム単位)
          allOf:
            - $ref: '#/components/schemas/TotalResultDto'
        single:
          description: 個人記録(プレイヤー単位)
          allOf:
            - $ref: '#/components/schemas/SingleResultDto'
        stats:
          description: 総合統計(旧Stats統計)
          allOf:
            - $ref: '#/components/schemas/LegacyStatsDto'
      required:
        - waves
        - total
        - single
        - stats
    NicknameAndIcon:
      type: object
      properties:
        nickname:
          type: string
        nsa_id:
          type: string
        thumbnail_url:
          type: string
      required:
        - nickname
        - nsa_id
        - thumbnail_url
    NicknameAndIconResponseDto:
      type: object
      properties:
        nickname_and_icons:
          type: array
          items:
            $ref: '#/components/schemas/NicknameAndIcon'
      required:
        - nickname_and_icons
    PaginatedDto:
      type: object
      properties:
        total:
          type: integer
          description: 総数
        limit:
          type: integer
          description: 取得数
        offset:
          type: integer
          description: オフセット
      required:
        - total
        - limit
        - offset
    JobResult:
      type: object
      properties:
        failure_reason:
          type: string
          enum:
            - time_limit
            - wipe_out
          nullable: true
          example: null
          description: バイト失敗理由
        failure_wave:
          type: number
          nullable: true
          example: null
          description: バイト失敗WAVE数
        is_clear:
          type: boolean
          example: true
          description: クリアしたかどうか
      required:
        - failure_reason
        - failure_wave
        - is_clear
    Player:
      type: object
      properties:
        nsaid:
          type: string
          example: '0000000000000000'
          description: プレイヤーID
        name:
          type: string
          example: tkgling
          description: プレイヤー名
        job_id:
          type: number
          description: バイト回数
        boss_kill_counts:
          example:
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
          description: オオモノ討伐数
          type: array
          items:
            type: number
        dead_count:
          type: number
          description: 被救助数
        golden_ikura_num:
          type: number
          description: 金イクラ数
        help_count:
          type: number
          description: 救助数
        ikura_num:
          type: number
          description: 赤イクラ数
        grade_id:
          type: number
          description: 評価
        grade_point:
          type: number
          description: 評価レート
        grade_point_delta:
          type: number
          description: 評価レート変動
        special_id:
          type: number
          description: 支給スペシャル
        special_counts:
          description: スペシャル使用回数
          type: array
          items:
            type: number
        weapon_list:
          description: 支給ブキ
          type: array
          items:
            type: number
      required:
        - nsaid
        - name
        - job_id
        - boss_kill_counts
        - dead_count
        - golden_ikura_num
        - help_count
        - ikura_num
        - grade_id
        - grade_point
        - grade_point_delta
        - special_id
        - special_counts
        - weapon_list
    Wave:
      type: object
      properties:
        event_type:
          type: number
          description: イベント
        water_level:
          type: number
          description: 潮位
        golden_ikura_num:
          type: number
          description: 金イクラ数
        golden_ikura_pop_num:
          type: number
          description: 金イクラドロップ数
        quota_num:
          type: number
          description: 金イクラノルマ数
        ikura_num:
          type: number
          description: 赤イクラ数
      required:
        - event_type
        - water_level
        - golden_ikura_num
        - golden_ikura_pop_num
        - quota_num
        - ikura_num
    Schedule:
      type: object
      properties:
        start_time:
          format: date-time
          type: string
          description: シフト開始時刻
        stage_id:
          type: string
          enum:
            - SHAKEUP
            - SHAKESHIP
            - SHAKEHOUSE
            - SHAKELIFT
            - SHAKELIDE
          example: 5000
          description: ステージID
        end_time:
          format: date-time
          type: string
          description: シフト終了時刻
        rare_weapon:
          type: number
          nullable: true
          default: null
          description: 支給レアブキ
        weapon_list:
          description: 支給ブキリスト
          type: array
          items:
            type: number
      required:
        - start_time
        - stage_id
        - end_time
        - rare_weapon
        - weapon_list
    Result:
      type: object
      properties:
        salmon_id:
          type: number
          description: リザルトID
        boss_counts:
          example:
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
          description: オオモノ出現数
          type: array
          items:
            type: number
        boss_kill_counts:
          example:
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
          description: オオモノ討伐数
          type: array
          items:
            type: number
        golden_ikura_num:
          type: number
          description: 金イクラ数
        ikura_num:
          type: number
          description: 赤イクラ数
        no_night_waves:
          type: boolean
          description: 夜WAVEを含むかどうか
        danger_rate:
          type: number
          description: キケン度
        end_time:
          format: date-time
          type: string
          description: シフト終了時刻
        play_time:
          format: date-time
          type: string
          description: プレイ時刻
        start_time:
          format: date-time
          type: string
          description: シフト開始時刻
        members:
          example:
            - '0000000000000000'
            - '1111111111111111'
            - '2222222222222222'
            - '3333333333333333'
          description: チームメンバー(ソート済み)
          type: array
          items:
            type: string
        job_result:
          description: バイト結果
          allOf:
            - $ref: '#/components/schemas/JobResult'
        players:
          description: プレイヤーリザルト
          type: array
          items:
            $ref: '#/components/schemas/Player'
        waves:
          description: WAVEリザルト
          type: array
          items:
            $ref: '#/components/schemas/Wave'
        schedule:
          description: スケジュール
          allOf:
            - $ref: '#/components/schemas/Schedule'
      required:
        - salmon_id
        - boss_counts
        - boss_kill_counts
        - golden_ikura_num
        - ikura_num
        - no_night_waves
        - danger_rate
        - end_time
        - play_time
        - start_time
        - members
        - job_result
        - players
        - waves
        - schedule
    Results:
      type: object
      properties:
        results:
          minItems: 1
          maxItems: 50
          type: array
          items:
            $ref: '#/components/schemas/Result'
      required:
        - results
    UploadResult:
      type: object
      properties:
        salmon_id:
          type: number
          description: リザルトID
        status:
          type: string
          enum:
            - created
            - updated
      required:
        - salmon_id
        - status
    UploadResults:
      type: object
      properties:
        results:
          type: array
          items:
            $ref: '#/components/schemas/UploadResult'
      required:
        - results
    RankResult:
      type: object
      properties:
        salmon_id:
          type: number
          description: リザルトID
        rank:
          type: number
          description: ランク
        golden_ikura_num:
          type: number
          description: 金イクラ数
        ikura_num:
          type: number
          description: 赤イクラ数
        members:
          example:
            - '0000000000000000'
            - '1111111111111111'
            - '2222222222222222'
            - '3333333333333333'
          description: チームメンバー(ソート済み)
          type: array
          items:
            type: string
      required:
        - rank
        - golden_ikura_num
        - ikura_num
    RankIkura:
      type: object
      properties:
        golden_ikura_num:
          description: 金イクラランキング
          allOf:
            - $ref: '#/components/schemas/RankResult'
        ikura_num:
          description: 赤イクラランキング
          allOf:
            - $ref: '#/components/schemas/RankResult'
        count:
          type: number
          description: 回数
      required:
        - golden_ikura_num
        - ikura_num
    RankTotal:
      type: object
      properties:
        all:
          description: 夜イベントを含む
          allOf:
            - $ref: '#/components/schemas/RankIkura'
        no_night_waves:
          description: 夜イベントを含まない
          allOf:
            - $ref: '#/components/schemas/RankIkura'
      required:
        - all
        - no_night_waves
    RankWaveEventHigh:
      type: object
      properties:
        water-levels:
          $ref: '#/components/schemas/RankResult'
        rush:
          $ref: '#/components/schemas/RankResult'
        goldie-seeking:
          $ref: '#/components/schemas/RankResult'
        griller:
          $ref: '#/components/schemas/RankResult'
        the-mothership:
          $ref: '#/components/schemas/RankResult'
        fog:
          $ref: '#/components/schemas/RankResult'
      required:
        - water-levels
        - rush
        - goldie-seeking
        - griller
        - the-mothership
        - fog
    RankWaveEventNormal:
      type: object
      properties:
        water-levels:
          $ref: '#/components/schemas/RankResult'
        rush:
          $ref: '#/components/schemas/RankResult'
        goldie-seeking:
          $ref: '#/components/schemas/RankResult'
        griller:
          $ref: '#/components/schemas/RankResult'
        the-mothership:
          $ref: '#/components/schemas/RankResult'
        fog:
          $ref: '#/components/schemas/RankResult'
      required:
        - water-levels
        - rush
        - goldie-seeking
        - griller
        - the-mothership
        - fog
    RankWaveEventLow:
      type: object
      properties:
        water-levels:
          $ref: '#/components/schemas/RankResult'
        the-mothership:
          $ref: '#/components/schemas/RankResult'
        fog:
          $ref: '#/components/schemas/RankResult'
        cohock-charge:
          $ref: '#/components/schemas/RankResult'
      required:
        - water-levels
        - the-mothership
        - fog
        - cohock-charge
    RankWave:
      type: object
      properties:
        high:
          $ref: '#/components/schemas/RankWaveEventHigh'
        normal:
          $ref: '#/components/schemas/RankWaveEventNormal'
        low:
          $ref: '#/components/schemas/RankWaveEventLow'
      required:
        - high
        - normal
        - low
    Rank:
      type: object
      properties:
        total:
          description: 総合記録ランク
          allOf:
            - $ref: '#/components/schemas/RankTotal'
        waves:
          description: WAVE記録ランク
          allOf:
            - $ref: '#/components/schemas/RankWave'
      required:
        - total
        - waves
